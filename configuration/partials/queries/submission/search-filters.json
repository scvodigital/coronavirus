{{#if @root.request.params.type ~}}
{{>queries_term field="type" term=(replace (replace @root.request.params.type 'needed' 'assistance') 'for-' '')}},
{{/if ~}}
{{#if @root.request.params.query.support ~}}
{{>queries_term field="support_category_slug" term=@root.request.params.query.support}},
{{/if ~}}
{{#if location ~}}
{
  "bool": {
    "should": [
      {{>queries_submission_search_filters_locations @root.request.params.query}}
      {{>queries_submission_search_filters_areas @root.request.params.query}}
      {
        "term": {
          "where_slug": "across-the-whole-of-scotland"
        }
      },
      {{>queries_do_nothing}}
    ],
    "minimum_should_match": {{#ifAll location lat lng distance}}2{{else}}3{{/ifAll}}
  }
},
{{/if ~}}
{{>queries_do_nothing}}